library(tmctools)

ply <- system.file("testdata", "tritext.ply", package = "tmctools")
testDF <- readPly(ply)

test_that("readPlyText works", {
  expect_equal(round(testDF$edge_length, digits = 3), c(210.013,
                                                        239.531,
                                                        162.426,
                                                        244.129,
                                                        175.534,
                                                        246.231,
                                                        203.798,
                                                        339.895,
                                                        236.139,
                                                        244.864,
                                                        246.231))
  expect_equal(
    testDF$polygon,
    c("POLYGON Z ((590959.048 1051453.793 0.000,590801.711 1051469.316 0.000,590979.768 1051357.956 0.000,590959.048 1051453.793 0.000))",
      "POLYGON Z ((590801.711 1051469.316 0.000,590742.991 1051321.735 0.000,590979.768 1051357.956 0.000,590801.711 1051469.316 0.000))",
      "POLYGON Z ((590979.768 1051357.956 0.000,591023.340 1051259.930 0.000,591124.338 1051283.918 0.000,590979.768 1051357.956 0.000))",
      "POLYGON Z ((590742.991 1051321.735 0.000,590945.741 1051185.752 0.000,590979.768 1051357.956 0.000,590742.991 1051321.735 0.000))",
      "POLYGON Z ((590979.768 1051357.956 0.000,590945.741 1051185.752 0.000,591023.340 1051259.930 0.000,590979.768 1051357.956 0.000))",
      "POLYGON Z ((590979.768 1051357.956 0.000,591124.338 1051283.918 0.000,591217.310 1051422.791 0.000,590979.768 1051357.956 0.000))",
      "POLYGON Z ((590945.741 1051185.752 0.000,591124.338 1051283.918 0.000,591023.340 1051259.930 0.000,590945.741 1051185.752 0.000))",
      "POLYGON Z ((590959.048 1051453.793 0.000,591135.024 1051535.881 0.000,590801.711 1051469.316 0.000,590959.048 1051453.793 0.000))",
      "POLYGON Z ((590979.768 1051357.956 0.000,591135.024 1051535.881 0.000,590959.048 1051453.793 0.000,590979.768 1051357.956 0.000))",
      "POLYGON Z ((590979.768 1051357.956 0.000,591173.372 1051507.875 0.000,591135.024 1051535.881 0.000,590979.768 1051357.956 0.000))",
      "POLYGON Z ((590979.768 1051357.956 0.000,591217.310 1051422.791 0.000,591173.372 1051507.875 0.000,590979.768 1051357.956 0.000))")
  )
})

rm(list = ls())
